--- origsrc/json-fortran-9.2.0/CMakeLists.txt	2026-01-06 05:11:50.000000000 +0900
+++ src/json-fortran-9.2.0/CMakeLists.txt	2026-01-13 12:11:54.964728000 +0900
@@ -129,9 +129,11 @@ endif ()
 # Put package export CMake files where they can be found
 # use `find_package ( jsonfortran-${CMAKE_Fortran_COMPILER_ID} <version> REQUIRED )`
 if (USE_GNU_INSTALL_CONVENTION)
-  set ( EXPORT_INSTALL_DIR "${INSTALL_LIB_DIR}/cmake/${PACKAGE_VERSION}" )
+  set ( EXPORT_INSTALL_DIR "${INSTALL_LIB_DIR}/cmake/${PACKAGE_VERSION}" CACHE PATH
+    "Directory for CMake package export files" )
 else ()
-  set ( EXPORT_INSTALL_DIR "${PACKAGE_VERSION}/cmake" )
+  set ( EXPORT_INSTALL_DIR "${PACKAGE_VERSION}/cmake" CACHE PATH
+    "Directory for CMake package export files" )
 endif ()
 
 if ( "${CMAKE_SYSTEM_NAME}" MATCHES "Darwin" )
@@ -173,21 +175,27 @@ if(CMAKE_Fortran_COMPILER_ID STREQUAL In
     set_property(TARGET ${LIB_NAME}-obj PROPERTY POSITION_INDEPENDENT_CODE 1)
 
     add_library ( ${LIB_NAME}        SHARED $<TARGET_OBJECTS:${LIB_NAME}-obj> )
-    add_library ( ${LIB_NAME}-static STATIC $<TARGET_OBJECTS:${LIB_NAME}-obj> )
+    if (NOT BUILD_SHARED_LIBS)
+      add_library ( ${LIB_NAME}-static STATIC $<TARGET_OBJECTS:${LIB_NAME}-obj> )
+    endif()
 else()
   if (JSONFORTRAN_STATIC_LIBRARY_ONLY)
     add_library ( ${LIB_NAME}        STATIC ${JF_LIB_SRCS} )
     add_library ( ${LIB_NAME}-static STATIC ${JF_LIB_SRCS} )
   else()
     add_library ( ${LIB_NAME}        SHARED ${JF_LIB_SRCS} )
-    add_library ( ${LIB_NAME}-static STATIC ${JF_LIB_SRCS} )
+    if (NOT BUILD_SHARED_LIBS)
+      add_library ( ${LIB_NAME}-static STATIC ${JF_LIB_SRCS} )
+    endif()
   endif()
 endif()
 
 # add an alias so that including json-fortran is agnostic
 # of find_package or being directly compiled through add_subdirectory
 add_library ( ${PACKAGE_NAME}::${LIB_NAME}        ALIAS ${LIB_NAME} )
-add_library ( ${PACKAGE_NAME}::${LIB_NAME}-static ALIAS ${LIB_NAME}-static )
+if (NOT BUILD_SHARED_LIBS)
+  add_library ( ${PACKAGE_NAME}::${LIB_NAME}-static ALIAS ${LIB_NAME}-static )
+endif()
 
 if(JSON_FORTRAN_USE_OpenCoarrays)
   target_link_libraries(${LIB_NAME}
@@ -200,29 +208,31 @@ target_include_directories(${LIB_NAME}
   PUBLIC
   $<BUILD_INTERFACE:${MODULE_DIR}>
   $<INSTALL_INTERFACE:${INSTALL_MOD_DIR}>)
-target_include_directories(${LIB_NAME}-static
-  PUBLIC
-  $<BUILD_INTERFACE:${MODULE_DIR}>
-  $<INSTALL_INTERFACE:${INSTALL_MOD_DIR}>)
-if(CMAKE_Fortran_COMPILER_ID STREQUAL IntelLLVM)
-    set_target_properties ( ${LIB_NAME}-static
-      PROPERTIES
-      if(NOT MSVC_IDE)
-      PREFIX lib
-      endif()
-      VERSION ${PROJECT_VERSION}
-      ARCHIVE_OUTPUT_DIRECTORY ${PROJECT_BINARY_DIR}/lib
-      Fortran_MODULE_DIRECTORY ${MODULE_DIR} )
-else()
-    set_target_properties ( ${LIB_NAME}-static
-      PROPERTIES
-      OUTPUT_NAME ${LIB_NAME}
-      if(NOT MSVC_IDE)
-      PREFIX lib
-      endif()
-      VERSION ${PROJECT_VERSION}
-      ARCHIVE_OUTPUT_DIRECTORY ${PROJECT_BINARY_DIR}/lib
-      Fortran_MODULE_DIRECTORY ${MODULE_DIR} )
+if (NOT BUILD_SHARED_LIBS)
+  target_include_directories(${LIB_NAME}-static
+    PUBLIC
+    $<BUILD_INTERFACE:${MODULE_DIR}>
+    $<INSTALL_INTERFACE:${INSTALL_MOD_DIR}>)
+  if(CMAKE_Fortran_COMPILER_ID STREQUAL IntelLLVM)
+      set_target_properties ( ${LIB_NAME}-static
+        PROPERTIES
+        if(NOT MSVC_IDE)
+        PREFIX lib
+        endif()
+        VERSION ${PROJECT_VERSION}
+        ARCHIVE_OUTPUT_DIRECTORY ${PROJECT_BINARY_DIR}/lib
+        Fortran_MODULE_DIRECTORY ${MODULE_DIR} )
+  else()
+      set_target_properties ( ${LIB_NAME}-static
+        PROPERTIES
+        OUTPUT_NAME ${LIB_NAME}
+        if(NOT MSVC_IDE)
+        PREFIX lib
+        endif()
+        VERSION ${PROJECT_VERSION}
+        ARCHIVE_OUTPUT_DIRECTORY ${PROJECT_BINARY_DIR}/lib
+        Fortran_MODULE_DIRECTORY ${MODULE_DIR} )
+  endif()
 endif()
 set_target_properties ( ${LIB_NAME}
   PROPERTIES
@@ -331,7 +341,11 @@ if ( ENABLE_TESTS )
   # emulate GNU Autotools `make check`
   add_custom_target(check COMMAND ${CMAKE_CTEST_COMMAND} -C $<CONFIG> --output-on-failure)
   add_custom_target(build_tests) # Make target to build all tests
-  add_dependencies(build_tests ${LIB_NAME} ${LIB_NAME}-static)
+  if (BUILD_SHARED_LIBS)
+    add_dependencies(build_tests ${LIB_NAME})
+  else()
+    add_dependencies(build_tests ${LIB_NAME} ${LIB_NAME}-static)
+  endif()
 
   find_program ( JSONLINT jsonlint )
 
@@ -453,10 +467,17 @@ endif ()
 # Perform the installation
 #-------------------------
 
-install ( TARGETS ${LIB_NAME} ${LIB_NAME}-static
-  EXPORT ${PACKAGE_NAME}-targets
-  LIBRARY DESTINATION "${INSTALL_LIB_DIR}"
-  ARCHIVE DESTINATION "${INSTALL_LIB_DIR}" )
+if (BUILD_SHARED_LIBS)
+  install ( TARGETS ${LIB_NAME}
+    EXPORT ${PACKAGE_NAME}-targets
+    RUNTIME DESTINATION "${INSTALL_BIN_DIR}"
+    ARCHIVE DESTINATION "${INSTALL_LIB_DIR}" )
+else()
+  install ( TARGETS ${LIB_NAME} ${LIB_NAME}-static
+    EXPORT ${PACKAGE_NAME}-targets
+    LIBRARY DESTINATION "${INSTALL_LIB_DIR}"
+    ARCHIVE DESTINATION "${INSTALL_LIB_DIR}" )
+endif()
 
 # Code to  fix the dylib install name on Mac.
 include ( cmake/fixupInstallNameDir.cmake )
--- origsrc/json-fortran-9.2.0/packaging/CMakeLists.txt	2026-01-06 05:11:50.000000000 +0900
+++ src/json-fortran-9.2.0/packaging/CMakeLists.txt	2026-01-13 12:06:12.959567700 +0900
@@ -26,7 +26,11 @@ install ( FILES
 #----------------------------------------------
 # Make build tree targets accessible for import
 #----------------------------------------------
-export ( TARGETS ${LIB_NAME} ${LIB_NAME}-static FILE ${PACKAGE_NAME}-targets.cmake )
+if (BUILD_SHARED_LIBS)
+  export ( TARGETS ${LIB_NAME} FILE ${PACKAGE_NAME}-targets.cmake )
+else()
+  export ( TARGETS ${LIB_NAME} ${LIB_NAME}-static FILE ${PACKAGE_NAME}-targets.cmake )
+endif()
 
 # build tree package config file, NOT installed
 configure_file (
