--- origsrc/libgdither-0.6/CMakeLists.txt	1970-01-01 09:00:00.000000000 +0900
+++ src/libgdither-0.6/CMakeLists.txt	2025-12-21 19:19:03.896978600 +0900
@@ -0,0 +1,65 @@
+cmake_minimum_required(VERSION 3.15)
+
+project(libgdither VERSION 0.6 LANGUAGES C)
+
+include(GNUInstallDirs)
+
+add_library(gdither SHARED
+    gdither.c
+)
+
+target_include_directories(gdither
+    PUBLIC
+        $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}>
+        $<INSTALL_INTERFACE:${CMAKE_INSTALL_INCLUDEDIR}/libgdither>
+)
+
+set_target_properties(gdither PROPERTIES
+    POSITION_INDEPENDENT_CODE ON
+    VERSION 1.0
+    SOVERSION 1
+)
+
+target_compile_options(gdither PRIVATE -ffast-math)
+
+# The original pkg-config file links -lm.
+if(UNIX)
+    target_link_libraries(gdither PRIVATE m)
+endif()
+
+install(TARGETS gdither
+    EXPORT libgditherTargets
+    LIBRARY DESTINATION ${CMAKE_INSTALL_LIBDIR}
+    ARCHIVE DESTINATION ${CMAKE_INSTALL_LIBDIR}
+    RUNTIME DESTINATION ${CMAKE_INSTALL_BINDIR}
+)
+
+install(FILES
+    gdither.h
+    gdither_types.h
+    DESTINATION ${CMAKE_INSTALL_INCLUDEDIR}/libgdither
+)
+
+# Generate libgdither.pc by taking the existing one in the source tree and
+# replacing a few fields with CMake install variables.
+set(_pc_source "${CMAKE_CURRENT_SOURCE_DIR}/libgdither.pc")
+if(EXISTS "${_pc_source}")
+    file(READ "${_pc_source}" _pc_contents)
+
+    # Replace the path variables.
+    string(REGEX REPLACE "prefix=[^\r\n]*" "prefix=${CMAKE_INSTALL_PREFIX}" _pc_contents "${_pc_contents}")
+    string(REGEX REPLACE "libdir=[^\r\n]*" "libdir=${CMAKE_INSTALL_FULL_LIBDIR}" _pc_contents "${_pc_contents}")
+    string(REGEX REPLACE "includedir=[^\r\n]*" "includedir=${CMAKE_INSTALL_FULL_INCLUDEDIR}" _pc_contents "${_pc_contents}")
+
+    # Replace Version field.
+    string(REGEX REPLACE "Version:[ \t]*[^\r\n]*" "Version: ${PROJECT_VERSION}" _pc_contents "${_pc_contents}")
+
+    file(WRITE "${CMAKE_CURRENT_BINARY_DIR}/libgdither.pc" "${_pc_contents}")
+else()
+    message(FATAL_ERROR "Expected pkg-config file not found: ${_pc_source}")
+endif()
+
+install(FILES
+    "${CMAKE_CURRENT_BINARY_DIR}/libgdither.pc"
+    DESTINATION ${CMAKE_INSTALL_LIBDIR}/pkgconfig
+)
--- origsrc/libgdither-0.6/gdither.c	2025-12-21 19:04:42.187433000 +0900
+++ src/libgdither-0.6/gdither.c	2025-12-21 19:21:40.972937100 +0900
@@ -121,6 +121,7 @@ GDither gdither_new(GDitherType type, un
 	s->clamp_u = lrintf(s->scale);
 	s->clamp_l = lrintf(-s->scale);
 	break;
+#if 0
     case 23:
 	/* special performance test case */
 	s->scale = SCALE_S24;
@@ -129,6 +130,7 @@ GDither gdither_new(GDitherType type, un
 	s->clamp_u = 8388607;
 	s->clamp_l = -8388608;
 	break;
+#endif
     default:
 	/* Not a bit depth we can handle */
 	free(s);
