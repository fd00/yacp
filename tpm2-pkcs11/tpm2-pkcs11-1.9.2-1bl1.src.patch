--- origsrc/tpm2-pkcs11-1.9.2/Makefile.am	2026-02-05 20:50:17.508743500 +0900
+++ src/tpm2-pkcs11-1.9.2/Makefile.am	2026-02-05 20:52:34.343080900 +0900
@@ -11,6 +11,8 @@ AM_LDFLAGS      = $(EXTRA_LDFLAGS) $(COD
                   $(TSS2_MU_LIBS) $(TSS2_TCTILDR_LIBS) $(TSS2_RC_LIBS) \
 		  $(SQLITE3_LIBS) $(PTHREAD_LIBS) $(CRYPTO_LIBS) $(YAML_LIBS) $(TSS2_FAPI_LIBS)
 
+src_libtpm2_pkcs11_la_LDFLAGS += -no-undefined
+
 check-programs: $(check_PROGRAMS)
 
 JAVAROOT=$(top_builddir)/test/integration
--- origsrc/tpm2-pkcs11-1.9.2/bootstrap	2025-09-30 04:57:29.000000000 +0900
+++ src/tpm2-pkcs11-1.9.2/bootstrap	2026-02-05 20:51:20.241219500 +0900
@@ -4,7 +4,7 @@ set -e
 
 # Generate a VERSION file that is included in the dist tarball to avoid needed git
 # when calling autoreconf in a release tarball.
-git describe --tags --always --dirty > VERSION
+test -f VERSION || git describe --tags --always --dirty > VERSION
 
 # generate list of source files for use in Makefile.am
 # if you add new source files, you must run ./bootstrap again
--- origsrc/tpm2-pkcs11-1.9.2/misc/p11-kit/tpm2_pkcs11.module	2025-09-30 04:57:29.000000000 +0900
+++ src/tpm2-pkcs11-1.9.2/misc/p11-kit/tpm2_pkcs11.module	2026-02-05 20:51:45.566175900 +0900
@@ -1,3 +1,3 @@
-module: libtpm2_pkcs11.so
+module: cygtpm2_pkcs11-1.dll
 
 critical: no
--- origsrc/tpm2-pkcs11-1.9.2/src/lib/db.c	2025-09-30 04:57:29.000000000 +0900
+++ src/tpm2-pkcs11-1.9.2/src/lib/db.c	2026-02-05 20:52:07.338400400 +0900
@@ -12,7 +12,9 @@
 #include <libgen.h>
 #include <unistd.h>
 
+#if defined(__linux__)
 #include <linux/limits.h>
+#endif
 
 #include <sys/file.h>
 #include <sys/stat.h>
